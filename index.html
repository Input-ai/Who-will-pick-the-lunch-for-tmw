<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>誰是倒楣鬼</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.0/gsap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/winwheel@2.8.1/Winwheel.min.js"></script>
<style>
  body { font-family:"Microsoft JhengHei",sans-serif; text-align:center; padding:30px; background:#f5f5f5; }
  h1 { font-size:36px; color:#c0392b; margin-bottom:20px; }
  canvas { display:block; margin:20px auto; }
  #controls input, #controls button { font-family:inherit; font-size:16px; padding:8px 12px; margin:5px; }
  #addBtn { background:#27ae60;color:#fff;border:none;border-radius:4px;cursor:pointer; }
  #spinBtn { background:#2980b9;color:#fff;border:none;border-radius:4px;cursor:pointer; }
  #result { margin-top:30px;font-size:24px;color:#e74c3c;font-weight:bold; }
</style>
</head>
<body>
  <h1>誰是倒楣鬼</h1>
  <canvas id="wheelCanvas" width="500" height="500"></canvas>
  <div id="controls">
    <input type="text" id="addInput" placeholder="新增選項">
    <button id="addBtn">新增選項</button>
    <button id="spinBtn">開始轉動！</button>
  </div>
  <div id="result"></div>

  <script>
    let options = ["YY","Tina","Lynn","Hermia","Michelle","Alison"];
    let wheel;

    function createWheel() {
      const colors = ['#f39c12','#e74c3c','#2ecc71','#9b59b6','#3498db','#e67e22'];
      const segs = options.map((name,i)=>({
        fillStyle: colors[i % colors.length],
        text: name
      }));

      wheel = new Winwheel({
        canvasId: 'wheelCanvas',
        responsive: true,
        numSegments: segs.length,
        segments: segs,
        textFontSize: 18,
        pointerAngle: 90,
        pointerGuide: { display: true, strokeStyle: 'navy', lineWidth: 4 },
        animation: {
          type: 'spinToStop',
          duration: 5,
          spins: 8,
          easing: 'Power3.easeOut',
          callbackBefore: function() { 
            wheel.draw(); wheel.drawPointerGuide(); 
          },
          callbackAfter: function() {
            wheel.draw(); wheel.drawPointerGuide();
          },
          callbackFinished: function(seg) {
            wheel.draw(); wheel.drawPointerGuide();
            document.getElementById('result').textContent = `🎯 倒楣鬼是：${seg.text}`;
          }
        }
      });

      wheel.draw(); 
      wheel.drawPointerGuide();
    }

    document.getElementById('addBtn').addEventListener('click', ()=>{
      const v = document.getElementById('addInput').value.trim();
      if(v) { options.push(v); document.getElementById('addInput').value=''; createWheel(); }
    });

    document.getElementById('spinBtn').addEventListener('click', ()=>{
      if(wheel) {
        document.getElementById('result').textContent = '';
        wheel.startAnimation();
      }
    });

    createWheel();
  </script>
</body>
</html>